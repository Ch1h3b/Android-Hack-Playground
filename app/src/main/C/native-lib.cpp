#include <jni.h>
#include <string>

std::string str0 ="DG3MH417I0QYZOF7";
std::string str1 ="WZ67LXHFOK710Q06";
std::string str2 ="0KCRDBIRQF2IKEKW";
std::string str3 ="WAPKDRMTCS5M87G2";
std::string str4 ="2OV8UAVE4SJHITIU";
std::string str5 ="OO1C6GR2DKGYLT8V";
std::string str6 ="O02BG8323PENBI8S";
std::string str7 ="I9BR7SQJ3Y1FEH6S";
std::string str8 ="HWB3B6XQFJVBE9WC";
std::string str9 ="76RMV2G0VGZRKN1O";
std::string str10 ="WX5H40BVC2B1M2TT";
std::string str11 ="H4NOMQC6OKT50YJY";
std::string str12 ="M5EKJYXP3114A547";
std::string str13 ="LVGY0N0BM1E8SHTJ";
std::string str14 ="9M4SRP5SNW8UTZMH";
std::string str15 ="LWYONFABB0H7PWZ9";
std::string str16 ="8BORA7IRF6MDC7BG";
std::string str17 ="ZUPE66P8JOUUOPQ8";
std::string str18 ="HPUCWGEUFJCOKCUI";
std::string str19 ="S3OFXN93A7D0D1CU";
std::string str20 ="AR5JZO0VLNDGD611";
std::string str21 ="M5EKJYXP3114A547";
std::string str22 ="ZE7M32OZMAGR11W4";
std::string str23 ="WU2LRU6NZCQ7Q9FW";
std::string str24 ="0KEHXMX41CQMZ6T9";
std::string str25 ="BKSEOIMURZJWDRBQ";
std::string str26 ="ATFXNIXOT0HBCEQT";
std::string str27 ="MV7U08HHJNNABULF";
std::string str28 ="CTECPV6AI64KGV3O";
std::string str29 ="EQE9T3CULRQT82AQ";
std::string str30 ="TMXTCDONMAWXSAO4";
std::string str31 ="2WIQCD5TDH7OQSQ1";
std::string str32 ="OHWR3PQEYK7A6GSA";
std::string str33 ="MEJSF3FQ3OBH6FIM";
std::string str34 ="Y5I5KOPTKFXS3H2F";
std::string str35 ="5FB1MN72SRBYFU6I";
std::string str36 ="SVVOJL9FO0B7ZC4J";
std::string str37 ="WLQXHHMUPO30N8WX";
std::string str38 ="8AF2K56G8FP82CMO";
std::string str39 ="O2YY9SPJ6DF0TXSW";
std::string str40 ="HTPWZ8JC4BO22WT6";
std::string str41 ="GSFI7DZJ3KH7ODO7";
std::string str42 ="86QZQ3NVD35HLQSM";
std::string str43 ="R2IJBDIPO3MM4W0Z";
std::string str44 ="SU8W2Y4HOLRXTCH3";
std::string str45 ="33CQ79B32M8Z99V3";
std::string str46 ="EQWFBZQDGWPJISWZ";
std::string str47 ="8E3LBA2ZAPTOYE7N";
std::string str48 ="ACNMW8U29GE07H4R";
std::string str49 ="O6KKNIY6XN7BXSQ1";
std::string str50 ="LSN0R6OG5QTNJCKD";
std::string str51 ="DQRM739M1FTLSIFA";
std::string str52 ="NI1VOGFR01IECXFS";
std::string str53 ="T0S4BNX04KZKR90J";
std::string str54 ="4LHRIHKXL9TV097I";
std::string str55 ="CSDL8KLFO08CTGM5";
std::string str56 ="YVXBXI8NGYAKSM25";
std::string str57 ="X7XH8UTW4OTE8DAB";
std::string str58 ="GLTH0B8FJIMNH2ZJ";
std::string str59 ="91AL6MEOSXTBLWFX";
std::string str60 ="U5YBPQHZWQ4Z65CB";
std::string str61 ="63LST7C4E18LA024";
std::string str62 ="5CAB2EIAMFQVR0QM";
std::string str63 ="PZCW29FDKPRP3G4U";
std::string str64 ="H9PSNXM1HA28ELGE";
std::string str65 ="S4PM1RD94OGSZ456";
std::string str66 ="CRPRBG06IHACTG12";
std::string str67 ="9SI6D58Z0CAH2VTH";
std::string str68 ="9ZG52FAAUNVZB6X8";
std::string str69 ="W1WL9B2QF3XHTCD0";
std::string str70 ="1IH828V8UO1VOZ99";
std::string str71 ="BERPGKJ0U7ZG4OJP";
std::string str72 ="O22QX388K99TIO43";
std::string str73 ="59EXT2YB58SS8RB1";
std::string str74 ="Q9NLG8GMG77279JR";
std::string str75 ="123HEKWLFE25Z8RB";
std::string str76 ="KM3MLS8SOQHWNFT7";
std::string str77 ="0IC445K91FPBUR10";
std::string str78 ="LX6QRR81FC3M0AI6";
std::string str79 ="0SEDXEC3T36CKUKS";
std::string str80 ="ZWW3YCGO0VBGRM4K";
std::string str81 ="MEC2BEKDL6W0XAGC";
std::string str82 ="I5J490WBJP6R3L22";
std::string str83 ="T3L3E9MHIRZ0769Z";
std::string str84 ="7FMN21HJLILM6HGT";
std::string str85 ="DMT6EAD7KWPZ74S2";
std::string str86 ="PE3X9ZGLM4TFDXAU";
std::string str87 ="M86DUSQ2GZVEZCNT";
std::string str88 ="29XX5GVDLOLUDPC6";
std::string str89 ="191NMEPEJP3FTCXI";
std::string str90 ="V17R1NJ3OY08IMO1";
std::string str91 ="D7YJ8SXT411K5PSK";
std::string str92 ="KRHN8R1XB8GFMLQF";
std::string str93 ="D56BTVTVRR5Y96UD";
std::string str94 ="P09PP030YD6EH7Z2";
std::string str95 ="CWDTSQCF5G2I0J1C";
std::string str96 ="VZFC0A2ZE1M7HP02";
std::string str97 ="7ZEE8DKQNO67WP5J";
std::string str98 ="QMS8L2RF3VX7SUG4";
std::string str99 ="NG74CH2QI5LWPZK2";
std::string str100 ="GD7XSJIQZIYQSVDJ";
std::string str101 ="QU37U0Q5PPX326VD";
std::string str102 ="2DN2DTY394LQ7ISS";
std::string str103 ="3M6VZDVBB8AYK8UN";
std::string str104 ="0H7WJU1FWIJOBR8R";
std::string str105 ="OY42CG7ORC3PG3EK";
std::string str106 ="Q82IW6J4BBF8JOW6";
std::string str107 ="1G40CBXZ7JVZBUUB";
std::string str108 ="J00X0VZODUREGMU0";
std::string str109 ="9PJXRAKNE3WRKMBK";
std::string str110 ="JMMJSFDNI1725ZSK";
std::string str111 ="PL22YOAOZAM8RR78";
std::string str112 ="UWL1QJSTCPCIYSVD";
std::string str113 ="SPCL8JVHR5S7WAWX";
std::string str114 ="T3KOD0RPCUCIT2R8";
std::string str115 ="QG8Z3RSYT2MKDNFI";
std::string str116 ="QF2KQEL884A88D8P";
std::string str117 ="1JYTVRO5VG22AG9S";
std::string str118 ="6ZIA9HR7NW3SJXKY";
std::string str119 ="WT1TXP72Y8LUEWU2";
std::string str120 ="U1T78PRTNA7AVXPV";
std::string str121 ="TXAPSULIIJVREIFA";
std::string str122 ="J145DPDYJIY5Q1Q1";
std::string str123 ="LF2PCL9ZOE3SKN5Y";
std::string str124 ="WZ6HZ7VWAHBP6YBD";
std::string str125 ="MEHVA2DAM4Y771H5";
std::string str126 ="PGCIO80NKHM2FE3V";
std::string str127 ="57N7JF8WWIIMGZTV";
std::string str128 ="1QD2MOGZWMG6SY7Q";
std::string str129 ="S3D12935874MWWMJ";
std::string str130 ="OCWQYCNQGQ9JU5R6";
std::string str131 ="86DH18V954M3M5SC";
std::string str132 ="OI356BZE5YIN9U8W";
std::string str133 ="T9PLH1BSUI7UXKWF";
std::string str134 ="712DL0MVW3N2KHNP";
std::string str135 ="RAAF5DXBCQ9QQK8M";
std::string str136 ="NPXA2Z88Q0Q1EZYB";
std::string str137 ="YH6CZYKTUK9D5O58";
std::string str138 ="HAIPJ1YW09CAC3DN";
std::string str139 ="9PAR3I0QUUKQC4QL";
std::string str140 ="SIOHF9YZVXOARNZ9";
std::string str141 ="EBSXBVR7T3H6RZQL";
std::string str142 ="UFXTM5HFMJRMLACV";
std::string str143 ="4DP7IB8XUWKEY0A2";
std::string str144 ="VAKS8M348ORXXJ5N";
std::string str145 ="8BK9QJ8VHHBKSMWT";
std::string str146 ="AZKKQ3M0KR5HK3QG";
std::string str147 ="H1SNEJ7IVSD4TH70";
std::string str148 ="0PSDG0TRRE9XBG06";
std::string str149 ="NSZLS06I0Y4RFT3F";
std::string str150 ="Y2UW4BECDV8EN9Q8";
std::string str151 ="DTOWVP1W920L6YAR";
std::string str152 ="K4NSK244HRBU0794";
std::string str153 ="XQ6F1M6ROFQWK6TY";
std::string str154 ="A20IUJ5IHHD7JJX6";
std::string str155 ="3ADJKXKD3Z5NMGR6";
std::string str156 ="SF72L1J4UJCGDWRH";
std::string str157 ="WR0ZQ2GTAPISVKQY";
std::string str158 ="KK6Q2VV2PECPHGRM";
std::string str1587="WA9T,6G#NBE&@+@F";
std::string str159 ="Y1H01H13UO3LG0DW";
std::string str160 ="2VC4NXHS672P9Q4A";
std::string str161 ="23J85DYT28RJXESD";
std::string str162 ="8P9ISDVKO9NS1OFJ";
std::string str163 ="0CVG4W0X825T2B3J";
std::string str164 ="CHCEJ6ZPFXJBV3SA";
std::string str165 ="QS1RKDJK4SVZS42D";
std::string str166 ="QOFYMQGR56D5I0V7";
std::string str167 ="UH7SH02JWZ7JHMA7";
std::string str168 ="CHTGFEVTDRY16DRV";
std::string str169 ="13N03XVQJTW3H51H";
std::string str170 ="VUGZRT4FO3E5E1YO";
std::string str171 ="8CLYKEDR6HIU9W4P";
std::string str172 ="7ZZIS4OR7SSW1URV";
std::string str173 ="1OSNMYJ3Q2NUFAR3";
std::string str174 ="4LDF7YETD3MYZSE0";
std::string str175 ="ECM9WNTUUQOIDDR9";
std::string str176 ="UL2ACAA9SY44CPBW";
std::string str177 ="0DD7CEHR6WKGPO4W";
std::string str178 ="S4W35MRXPGR3O05H";
std::string str179 ="G21FQLLKOJOKYXH3";
std::string str180 ="H2S4R2HARY14PLD7";
std::string str181 ="ZLKQCLAVSKNDAXBW";
std::string str182 ="IHV7IX3PDTD06EKL";
std::string str183 ="R5OV6GCVP6FVBYQH";
std::string str184 ="0RSGZD4NAE8ZYG8P";
std::string str185 ="RIZG5C7QQ78KQBSW";
std::string str186 ="VX8LOIR0SUQ8J1SS";
std::string str187 ="0P9W54MUFQSY9T87";
std::string str188 ="66MKNNL469A23TG1";
std::string str189 ="6CU8HPIT586YCWY3";
std::string str190 ="7ACR1N9LOHHFLM19";
std::string str191 ="DBYYPIDKTM8I4ZR5";
std::string str192 ="B4BN231B4JTQVMJV";
std::string str193 ="J2YXUGSMX3DLU57W";
std::string str194 ="13QPD8E6GPM2WAG5";
std::string str195 ="2YJJON7MQRI92WPG";
std::string str196 ="32CWXWDZUM6CL6GW";
std::string str197 ="ZPCJNAVU2MFMH2SE";
std::string str198 ="RT6VP9MV7A1GGMGA";
std::string str199 ="M4KANRRKE68SJ3R2";



extern "C" JNIEXPORT jstring JNICALL Java_com_example_ram_A_keym(JNIEnv* env, jobject /* this */, jstring js) {

    std::string result;

    size_t len1 = str1.length();
    size_t len2 = str1.length();
    size_t len = (len1 < len2) ? len1 : len2;
    size_t lenjs = str11.length();



    int sum = 1;
    std::string sj = env->GetStringUTFChars(js, nullptr);
    //for (size_t j= lenjs-1; j>= 0; j--){
        //sum = (sum+ static_cast<int>(sj[j]) )%256;

    //}



    if(sum==0){
        std::string tmp = "aaaaaaaaaaaaaaaa";
        return env->NewStringUTF(str67.c_str());
    }



    for (size_t i = 0; i < 16; i++) {
        result += str1[i] ^ str2[i] ^ str3[i];

    }
    if (len>>1 < 8){
        std::reverse(result.begin(), result.end());
        return env->NewStringUTF(result.c_str());
    }


    //prob here
    std::string r;
    for (int i = 0; i<16; i++){
        char c = str44[i]^ str55[i] ^ str14[i]^ str199[i]^ str35[i]^ str31[i]^ str13[i]^str12[i]^ str11[i]^ str110[i]^ str90[i]^ str77[i]^ str66[i]^ str12[i];
        r += c;
    }


    if (str44.compare(r) == 0) {
        r+='s';
        return env->NewStringUTF(r.c_str());
    }





    // lets do it here
    std::string resut;
    for (size_t i = 15; i>0; i--){
        resut += str1587[i]^str45[i]^ str34[i]^ str199[i]^ str35[i]^ str33[i]^ str13[i]^str19[i]^ str11[i]^ str110[i]^ str190[i]^ str77[i]^ str66[i]^ str16[i];
    }



    if (str12.compare(str21) == 0) {
        resut += 'i';
        std::reverse(resut.begin(), resut.end());
        return env->NewStringUTF(resut.c_str());
    }

    std::string nr;
    int i;
    for (size_t d= 16; d>=0; d++){
        i = d;
        nr += str4[i]^str5[i]^ str4[i]^ str19[i]^ str3[i]^ str1[i]^ str3[i]^str2[i]^ str11[i]^ str10[i]^ str90[i]^ str77[i]^ str66[i]^ str2[i];
    }


    if (len << 2 < 64){
        return env->NewStringUTF(result.c_str());
    }else{
        std::string tmp = "ccccccccccc";
        return env->NewStringUTF(nr.c_str());
    }


}

extern "C" JNIEXPORT jstring JNICALL Java_com_example_ram_B_keym(JNIEnv* env, jobject /* this */, jstring js) {
    std::string tmp = "ABCDEFGHIJKL";
    return env->NewStringUTF(tmp.c_str());
}

extern "C" JNIEXPORT jstring JNICALL Java_com_example_ram_C_keym(JNIEnv* env, jobject /* this */, jstring js) {
    std::string k;
    for (int i = 0; i<16; i++){
        char c = str44[i]^ str55[i] ^ str14[i]^ str199[i]^ str35[i]^ str31[i]^ str13[i]^str12[i]^ str11[i]^ str110[i]^ str90[i]^ str77[i]^ str66[i]^ str12[i];
        k += c;
    }


    if (str137.compare(k) == 0) {
        k+='s';
        return env->NewStringUTF(k.c_str());
    }
}